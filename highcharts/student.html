<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="UTF-8">
  <meta content="noindex, nofollow" name="robots">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <title></title>

  <!-- Favicon -->
  <link rel="icon" href="data:,">

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans:ital,wght@0,400;0,700;1,400;1,700&display=swap"
    rel="stylesheet">

  <!-- Font Awesome -->
  <script defer src="https://assets.share-wis.com/libs/font-awesome/6.6.0/solid.min.js"></script>
  <script defer src="https://assets.share-wis.com/libs/font-awesome/6.6.0/fontawesome.min.js"></script>

  <!-- Highcharts -->
  <script src="https://assets.share-wis.com/libs/highcharts@11/highcharts.js"></script>
  <script src="https://assets.share-wis.com/libs/highcharts@11/accessibility.js"></script>

  <!-- Tailwind CSS -->
  <script src="https://assets.share-wis.com/libs/tailwindcss@3/tailwindcss.js"></script>

  <style>
    body {
      font-family: 'Noto Sans', sans-serif;
      color: #212121;
    }

    table {
      border-collapse: collapse;
      /* Ensures borders don't double up */
      border-radius: 8px;
      /* Adjust the radius as needed */
      overflow: hidden;
      /* Ensures content respects rounded corners */
      width: 100%;
      table-layout: auto;
    }

    th,
    td {
      border: 1px solid #D4D4D8;
      /* Border for individual cells */
    }

    .loading-container {
      visibility: visible;
    }
  </style>
</head>

<body class="bg-white">
  <div class="w-full mx-auto p-6 bg-white">
    <h2 id="username" class="text-2xl font-semibold text-center mb-4 border border-[#BDBDBD] p-2 rounded-lg">
      さんのスコア表</h2>
    <p id="courseTitle" class="text-right font-normal text-gray-500 mb-8"><br>受験日：</p>
    <p class="text-left text-base font-normal text-gray-500 mb-8 border border-[#BDBDBD] p-2 py-3 rounded-lg">
      このスコア表では、各問題の特性と内容、正誤から、ロボット製作を通じてお子様に身についている力について解説しております。今回の検定と解説からさまざまな気づきや発見を得ていただき、ぜひこれからもロボット製作を通じて、様々なスキル・知識を身につけるきっかけになれば幸いです。
    </p>
    <div class="section mb-8">
      <div class="flex items-center space-x-2 mb-4">
        <i class="fas fa-play-circle"></i>
        <h3 class="text-xl font-semibold">あなたの各カテゴリごとの正答率</h3>
      </div>
      <div class="flex flex-col lg:flex-row justify-center lg:space-y-0 lg:space-x-4">
        <div id="accuracy-chart" class="w-full lg:w-1/2" style="height: 400px;"></div>
        <div id="score-chart" class="w-full lg:w-1/2" style="height: 400px;"></div>
      </div>
    </div>

    <!-- Category Table -->
    <table id="category-table" class="w-full table-auto rounded-lg hidden lg:table">
      <thead class="text-center text-white bg-[#666666]">
        <tr>
          <th class="w-32 py-3 font-semibold text-base">問題特性</th>
          <th class="py-3 font-semibold text-base">カテゴリの説明</th>
          <th class="py-3 font-semibold text-base">実際にロボット製作でたとえると</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td class="text-center text-white font-semibold text-base bg-[#FF19B6]">空間把握</td>
          <td class="text-left text-[#212121] font-normal text-sm p-4">
            物の形や大きさ、位置や向きなどを頭の中でイメージする力です。ロボットのパーツやギアがどのようにつながるか、完成したロボットがどのように動くか、改造するとどう動きがかわるかなどを、より詳しく予想できるようになります。
          </td>
          <td class="text-left text-[#212121] font-normal text-sm p-4">
            紙の図面から立体を想像したり、ロボットが動いた先で何が起こるかを予測したりするためには、空間把握能力が必要です。<br>
            ロボットの形や動きを考えていく上で重要な力といえます。</td>
        </tr>
        <tr>
          <td class="text-center text-white font-semibold text-base bg-[#FFA13C]">判断推理</td>
          <td class="text-left text-[#212121] font-normal text-sm p-4 bg-[#F5F5F5]">
            いま分かっていることをヒントに、まだ分からないことについて考える力です。<br>ロボットが上手く動かないときその動きを分析して原因を見つけたり、改造したロボットを観察してもっとすぐれた改造を追加したりするのに役立ちます。
          </td>
          <td class="text-left text-[#212121] font-normal text-sm p-4 bg-[#F5F5F5]">
            ロボットを作る現場では、発生している異音から原因を推理したり、ねじが緩んでいる箇所から力が加わるパーツを推理したりと、状況を見て判断することが多々あります。<br>
            ロボットの状態を分析する上で重要な力といえます。</td>
        </tr>
        <tr>
          <td class="text-center text-white font-semibold text-base bg-[#009C00]">資料解釈</td>
          <td class="text-left text-[#212121] font-normal text-sm p-4">
            書かれている情報やヒントを読み取って、いま必要なことだけを探し出したり、ヒントをくみあわせて次のヒントを生み出す力です。<br>
            教科書や見本のロボットを観察して自分のロボット作りに活かしたり、動物や身の回りの機械を観察してオリジナルロボット作りのネタにしたりするのに役立ちます。</td>
          <td class="text-left text-[#212121] font-normal text-sm p-4">
            ロボットを作るのに必要な部品を選定する際には、部品の性能や取り扱い方法が記載された「データシート」と呼ばれる資料を読み込む必要があります。<br>
            ロボットをどのように作るべきか、どのような部品を選定すべきかを資料から読み取る上で、重要な力といえます。</td>
        </tr>
        <tr>
          <td class="text-center text-white font-semibold text-base bg-[#004BFF]">数的推理</td>
          <td class="text-left text-[#212121] font-normal text-sm p-4 bg-[#F5F5F5]">数字や図形を見て計算をしたり、ルールを見つけたりする力です。<br>
            ロボットの大きさや動く距離、ギアが何回転するか、パーツが動いたとき邪魔になるパーツはあるか、改造には何ポチのパーツを使うべきかなどを詳しく考えるのに役立ちます。</td>
          <td class="text-left text-[#212121] font-normal text-sm p-4 bg-[#F5F5F5]">
            要求されている仕様通りにロボットを設計するためには、事前の綿密な計算が不可欠です。動作に必要なパワーや、ロボットの大きさなどの数値は、動作環境に合わせて正しく計算して導き出す必要があります。<br>
            ロボットを設計していく上で重要な力といえます。</td>
        </tr>
      </tbody>
    </table>

    <!-- Score Table -->
    <table id="score-table" class="w-full table-auto rounded-lg mt-12 hidden lg:table">
      <thead class="text-center text-white bg-[#666666]">
        <tr>
          <th class="w-32 py-3 font-semibold text-base">問題特性</th>
          <th class="w-60 py-3 font-semibold text-base">あなたのスコア <br>(S-B)</th>
          <th class="py-3 font-semibold text-base">あなたへのコメント</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td class="text-center text-white font-semibold text-base bg-[#FF19B6]">空間把握</td>
          <td id="spatialAwarenessAlpha" class="text-center text-[#212121] font-normal text-[34px] p-4">

          </td>
          <td id="spatialAwarenessLabel" class="text-left text-[#212121] font-normal text-sm p-4">

          </td>
        </tr>
        <tr>
          <td class="text-center text-white font-semibold text-base bg-[#FFA13C]">判断推理</td>
          <td id="logicalReasoningAlpha" class="text-center text-[#212121] font-normal text-[34px] p-4 bg-[#F5F5F5]">

          </td>
          <td id="logicalReasoningLabel" class="text-left text-[#212121] font-normal text-sm p-4 bg-[#F5F5F5]">

          </td>
        </tr>
        <tr>
          <td class="text-center text-white font-semibold text-base bg-[#009C00]">資料解釈</td>
          <td id="dataInterpretationAlpha" class="text-center text-[#212121] font-normal text-[34px] p-4">

          </td>
          <td id="dataInterpretationLabel" class="text-left text-[#212121] font-normal text-sm p-4">

          </td>
        </tr>
        <tr>
          <td class="text-center text-white font-semibold text-base bg-[#004BFF]">数的推理</td>
          <td id="numericalReasoningAlpha" class="text-center text-[#212121] font-normal text-[34px] p-4 bg-[#F5F5F5]">

          </td>
          <td id="numericalReasoningLabel" class="text-left text-[#212121] font-normal text-sm p-4 bg-[#F5F5F5]">

          </td>
        </tr>
      </tbody>
    </table>

    <!-- Score Table Mobile -->
    <div class="w-full rounded-lg border-2 block overflow-hidden lg:hidden mt-8">
      <div class="bg-[#FF19B6] py-3 text-center text-white font-semibold text-[16px]">空間把握</div>
      <div class="p-3">
        <div class="font-semibold text-[14px] text-center text-[#666666]">あなたのスコア (S-B)</div>
        <div id="spatialAwarenessAlphaMobile" class="font-normal text-[34px] text-center text-[#212121] mt-3"></div>
      </div>
      <div class="p-3 border-t">
        <div class="font-semibold text-[16px] text-[#212121]">あなたへのコメント</div>
        <div id="spatialAwarenessLabelMobile" class="font-normal text-[14px] text-[#212121] mt-3"></div>
      </div>
      <div class="p-3 border-t">
        <div class="font-semibold text-[16px] text-[#212121]">カテゴリの説明</div>
        <div class="font-normal text-[14px] text-[#212121] mt-3">
          物の形や大きさ、位置や向きなどを頭の中でイメージする力です。ロボットのパーツやギアがどのようにつながるか、完成したロボットがどのように動くか、改造するとどう動きがかわるかなどを、より詳しく予想できるようになります。
        </div>
      </div>
      <div class="p-3 border-t">
        <div class="font-semibold text-[16px] text-[#212121]">実際にロボット製作でたとえると</div>
        <div class="font-normal text-[14px] text-[#212121] mt-3">
          紙の図面から立体を想像したり、ロボットが動いた先で何が起こるかを予測したりするためには、空間把握能力が必要です。
          <br>ロボットの形や動きを考えていく上で重要な力といえます。
        </div>
      </div>
    </div>

    <div class="w-full rounded-lg border-2 block overflow-hidden lg:hidden mt-8">
      <div class="bg-[#FFA13C] py-3 text-center text-white font-semibold text-[16px]">判断推理</div>
      <div class="p-3">
        <div class="font-semibold text-[14px] text-center text-[#666666]">あなたのスコア (S-B)</div>
        <div id="logicalReasoningAlphaMobile" class="font-normal text-[34px] text-center text-[#212121] mt-3"></div>
      </div>
      <div class="p-3 border-t">
        <div class="font-semibold text-[16px] text-[#212121]">あなたへのコメント</div>
        <div id="logicalReasoningLabelMobile" class="font-normal text-[14px] text-[#212121] mt-3"></div>
      </div>
      <div class="p-3 border-t">
        <div class="font-semibold text-[16px] text-[#212121]">カテゴリの説明</div>
        <div class="font-normal text-[14px] text-[#212121] mt-3">
          いま分かっていることをヒントに、まだ分からないことについて考える力です。ロボットが上手く動かないときその動きを分析して原因を見つけたり、改造したロボットを観察してもっとすぐれた改造を追加したりするのに役立ちます。
        </div>
      </div>
      <div class="p-3 border-t">
        <div class="font-semibold text-[16px] text-[#212121]">実際にロボット製作でたとえると</div>
        <div class="font-normal text-[14px] text-[#212121] mt-3">
          ロボットを作る現場では、発生している異音から原因を推理したり、ねじが緩んでいる箇所から力が加わるパーツを推理したりと、状況を見て判断することが多々あります。
          <br>ロボットの状態を分析する上で重要な力といえます。
        </div>
      </div>
    </div>

    <div class="w-full rounded-lg border-2 block overflow-hidden lg:hidden mt-8">
      <div class="bg-[#009C00] py-3 text-center text-white font-semibold text-[16px]">資料把握</div>
      <div class="p-3">
        <div class="font-semibold text-[14px] text-center text-[#666666]">あなたのスコア (S-B)</div>
        <div id="dataInterpretationAlphaMobile" class="font-normal text-[34px] text-center text-[#212121] mt-3"></div>
      </div>
      <div class="p-3 border-t">
        <div class="font-semibold text-[16px] text-[#212121]">あなたへのコメント</div>
        <div id="dataInterpretationLabelMobile" class="font-normal text-[14px] text-[#212121] mt-3"></div>
      </div>
      <div class="p-3 border-t">
        <div class="font-semibold text-[16px] text-[#212121]">カテゴリの説明</div>
        <div class="font-normal text-[14px] text-[#212121] mt-3">
          書かれている情報やヒントを読み取って、いま必要なことだけを探し出したり、ヒントをくみあわせて次のヒントを生み出す力です。
          <br>教科書や見本のロボットを観察して自分のロボット作りに活かしたり、動物や身の回りの機械を観察してオリジナルロボット作りのネタにしたりするのに役立ちます。
        </div>
      </div>
      <div class="p-3 border-t">
        <div class="font-semibold text-[16px] text-[#212121]">実際にロボット製作でたとえると</div>
        <div class="font-normal text-[14px] text-[#212121] mt-3">
          ロボットを作る現場では、発生している異音から原因を推理したり、ねじが緩んでいる箇所から力が加わるパーツを推理したりと、状況を見て判断することが多々あります。
          <br>ロボットの状態を分析する上で重要な力といえます。
        </div>
      </div>
    </div>

    <div class="w-full rounded-lg border-2 block overflow-hidden lg:hidden mt-8">
      <div class="bg-[#004BFF] py-3 text-center text-white font-semibold text-[16px]">数的推理</div>
      <div class="p-3">
        <div class="font-semibold text-[14px] text-center text-[#666666]">あなたのスコア (S-B)</div>
        <div id="numericalReasoningAlphaMobile" class="font-normal text-[34px] text-center text-[#212121] mt-3"></div>
      </div>
      <div class="p-3 border-t">
        <div class="font-semibold text-[16px] text-[#212121]">あなたへのコメント</div>
        <div id="numericalReasoningLabelMobile" class="font-normal text-[14px] text-[#212121] mt-3"></div>
      </div>
      <div class="p-3 border-t">
        <div class="font-semibold text-[16px] text-[#212121]">カテゴリの説明</div>
        <div class="font-normal text-[14px] text-[#212121] mt-3">数字や図形を見て計算をしたり、ルールを見つけたりする力です。
          <br>ロボットの大きさや動く距離、ギアが何回転するか、パーツが動いたとき邪魔になるパーツはあるか、改造には何ポチのパーツを使うべきかなどを詳しく考えるのに役立ちます。
        </div>
      </div>
      <div class="p-3 border-t">
        <div class="font-semibold text-[16px] text-[#212121]">実際にロボット製作でたとえると</div>
        <div class="font-normal text-[14px] text-[#212121] mt-3">
          要求されている仕様通りにロボットを設計するためには、事前の綿密な計算が不可欠です。動作に必要なパワーや、ロボットの大きさなどの数値は、動作環境に合わせて正しく計算して導き出す必要があります。
          <br>ロボットを設計していく上で重要な力といえます。
        </div>
      </div>
    </div>

    <!-- Score summary-->
    <div class="flex w-full justify-end mt-12">
      <div id="score-summary" class="inline-flex justify-center items-center ml-auto w-screen md:w-auto">
        <div
          class="bg-[#666666] h-24 flex items-center justify-center text-white text-[12px] md:text-base font-semibold whitespace-nowrap px-2 md:px-8 rounded-l-lg">
          総合スコア
        </div>
        <div class="flex items-center justify-center border border-[#BDBDBD] h-24 px-2 md:px-5 w-full md:w-auto">
          <!-- Row section: Score -->
          <div id="earnedScore" class="text-[#212121] text-[34px] md:text-5xl mr-2">
          </div>
          <!-- Column section: Remaining text -->
          <div class="flex flex-col mt-9 justify-center">
            <div id="totalScore" class="font-medium text-[16px] md:text-xl text-[#212121]">/ </div>
            <div id="passScore" class="font-normal text-[12px] md:text-sm whitespace-nowrap text-[#212121]">（合格点 点）
            </div>
          </div>
        </div>
        <div id="passStatus"
          class="flex items-center text-[#FF1986] font-semibold text-[24px] whitespace-nowrap md:text-3xl justify-center border-r border-t border-b border-[#BDBDBD] rounded-r-lg px-3 md:px-5 h-24">
        </div>
      </div>
    </div>
  </div>
  <div class="loading-container fixed inset-0 flex items-center justify-center bg-gray-100 bg-opacity-50 z-50"
    id="loadingSpinner">
    <div class="text-4xl text-[#00abc9]">
      <i class="fa fa-spinner fa-spin"></i>
    </div>
  </div>
  <script>
    function getCookie(name) {
      const cookies = document.cookie.split(';');
      for (let i = 0; i < cookies.length; i++) {
        const cookie = cookies[i].trim();
        if (cookie.startsWith(`${name}=`)) {
          return cookie.substring(name.length + 1);
        }
      }
      return null;
    }

    function getPathApi() {
      const protocol = window.location.protocol
      const hostname = window.location.hostname
      const path = window.location.pathname;

      return `${protocol}//${hostname}/api/v3${path}`
    }


    // Show the loading spinner
    function showLoadingSpinner() {
      document.getElementById('loadingSpinner').style.visibility = 'visible';
    }

    // Hide the loading spinner
    function hideLoadingSpinner() {
      document.getElementById('loadingSpinner').style.visibility = 'hidden';
    }

    // Call api
    async function getExamReportData() {
      const urlApi = getPathApi()
      if (urlApi === null) return

      const username = document.getElementById('username')
      const courseTitle = document.getElementById('courseTitle') // Including start date
      const earnedScore = document.getElementById('earnedScore')
      const totalScore = document.getElementById('totalScore')
      const passScore = document.getElementById('passScore')
      const passStatus = document.getElementById('passStatus')
      const authCookie = getCookie('Authorization') || '';
      try {
        const response = await fetch(urlApi, {
          headers: {
            "Content-Type": "application/json",
            "Authorization": "Bearer " + authCookie
          },
        })
        const responseJson = await response.json()

        if (responseJson != null && responseJson.exam != null && responseJson.user != null) {
          const exam = responseJson.exam
          const user = responseJson.user
          if (user.username != null) {
            username.textContent = user.username + ' さんのスコア表';
            document.title = user.username + ' さんのスコア表'
          } else {
            username.textContent = user.nickname + ' さんのスコア表';
            document.title = user.nickname + ' さんのスコア表'
          }

          courseTitle.innerHTML = exam.course.title + '<br>受験日：' + exam.startDate;
          earnedScore.textContent = exam.totalEarnedScore
          totalScore.textContent = '/ ' + exam.totalScore
          passScore.textContent = '（合格点' + exam.passScore + '点）'
          const isPass = false
          if (exam.isPass) {
            passStatus.textContent = '合格';
            passStatus.style.color = '#FF1986';
          } else {
            passStatus.textContent = '不合格';
            passStatus.style.color = '#212121';
          }
          updateChart(exam)
        }
      } catch (error) {

      } finally {
        hideLoadingSpinner()
      }
    }

    function updateChart(exam) {
      const quizzes = exam.quizzes
      const basic = quizzes.find((quiz) => quiz.tagName?.split("\n")?.includes("基礎")) //基礎
      const application = quizzes.find((quiz) => quiz.tagName?.split("\n")?.includes("応用")) //応用
      const practice = quizzes.find((quiz) => quiz.tagName?.split("\n")?.includes("実践")) //実践
      let basicPercent = Math.round((parseFloat(basic.earnedScore) / parseFloat(basic.maxScore)) * 100)
      basicPercent = basicPercent > 100 ? 100 : basicPercent
      let appPercent = Math.round((parseFloat(application.earnedScore) / parseFloat(application.maxScore)) * 100)
      appPercent = appPercent > 100 ? 100 : appPercent
      let pracPercent = Math.round((parseFloat(practice.earnedScore) / parseFloat(practice.maxScore)) * 100)
      pracPercent = pracPercent > 100 ? 100 : pracPercent
      // Data for the first chart (Accuracy by Category)
      Highcharts.chart('accuracy-chart', {
        chart: {
          type: 'column'
        },
        title: {
          text: ''
        },
        xAxis: {
          categories: ['基礎', '応用', '実践'],
          title: {
            text: null
          },
          labels: {
            useHTML: true, // Allows HTML formatting in labels
            formatter: function () {
              // Check the category and apply a specific color
              let color;
              if (this.value === '基礎') color = '#AC00FF';
              else if (this.value === '応用') color = '#CF6BFF';
              else if (this.value === '実践') color = '#DFA5FB';

              // Return the label with inline style
              return `<span style="color: ${color}; font-weight: normal;">${this.value}</span>`;
            }
          }
        },
        yAxis: {
          min: 0,
          max: 120, // Set the y-axis maximum to 100%
          tickInterval: 20, // Sets interval to display 0, 20, 40, 60, 80, 100
          title: {
            text: ''
          },
          labels: {
            enabled: true, // Show values on the left side
            formatter: function () {
              // Only display ticks up to 100, hide 120%
              return this.value === 120 ? null : this.value;
            }
          },
          gridLineWidth: 0,
          plotLines: [
            {
              value: 0,
              color: 'rgba(224, 224, 224, 1)',
              width: 1
            },
            {
              value: 20,
              color: 'rgba(224, 224, 224, 1)',
              width: 1
            },
            {
              value: 40,
              color: 'rgba(224, 224, 224, 1)',
              width: 1
            },
            {
              value: 60,
              color: 'rgba(224, 224, 224, 1)',
              width: 1
            },
            {
              value: 80,
              color: 'rgba(224, 224, 224, 1)',
              width: 1
            },
            {
              value: 100,
              color: 'rgba(224, 224, 224, 1)',
              width: 1
            }
          ]
        },
        tooltip: {
          enabled: false
        },
        series: [{
          data: [
            {
              y: basicPercent,
              color: '#AC00FF',
              dataLabels: {
                color: '#AC00FF',
                enabled: true,
                format: basicPercent + '%', // Set label to show 100%
                style: {
                  fontSize: '14px',
                  fontWeight: 'normal',
                  textOutline: 'none'
                },
              }
            }, // Color for 基礎
            {
              y: appPercent,
              color: '#CF6BFF',
              dataLabels: {
                color: '#CF6BFF',
                enabled: true,
                format: appPercent + '%', // Set label to show 100%
                style: {
                  fontSize: '14px',
                  fontWeight: 'normal',
                  textOutline: 'none'
                }
              }
            },  // Color for 応用
            {
              y: pracPercent,
              color: '#DFA5FB',
              dataLabels: {
                color: '#DFA5FB',
                enabled: true,
                format: pracPercent + '%',
                style: {
                  fontSize: '14px',
                  fontWeight: 'normal',
                  textOutline: 'none'
                }
              }
            }   // Color for 実践
          ],
          showInLegend: false, // Hides the legend
        }],
        plotOptions: {
          column: {
            colorByPoint: true,
          }
        },
        credits: {
          enabled: false
        }
      });

      const spatialAwareness = quizzes.find(quiz => quiz.tagName?.split("\n")?.includes("空間把握"));
      const logicalReasoning = quizzes.find(quiz => quiz.tagName?.split("\n")?.includes("判断推理"));
      const dataInterpretation = quizzes.find(quiz => quiz.tagName?.split("\n")?.includes("資料解釈"));
      const numericalReasoning = quizzes.find(quiz => quiz.tagName?.split("\n")?.includes("数的推理"));

      let spatialAwarenessPercent = Math.round((parseFloat(spatialAwareness.earnedScore) / parseFloat(spatialAwareness.maxScore)) * 100)
      spatialAwarenessPercent = spatialAwarenessPercent > 100 ? 100 : spatialAwarenessPercent
      let logicalReasoningPercent = Math.round((parseFloat(logicalReasoning.earnedScore) / parseFloat(logicalReasoning.maxScore)) * 100)
      logicalReasoningPercent = logicalReasoningPercent > 100 ? 100 : logicalReasoningPercent
      let dataInterpretationPercent = Math.round((parseFloat(dataInterpretation.earnedScore) / parseFloat(dataInterpretation.maxScore)) * 100)
      dataInterpretationPercent = dataInterpretationPercent > 100 ? 100 : dataInterpretationPercent
      let numericalReasoningPercent = Math.round((parseFloat(numericalReasoning.earnedScore) / parseFloat(numericalReasoning.maxScore)) * 100)
      numericalReasoningPercent = numericalReasoningPercent > 100 ? 100 : numericalReasoningPercent
      // Data for the second chart (Score per Category)
      Highcharts.chart('score-chart', {
        chart: {
          type: 'column'
        },
        title: {
          text: ''
        },
        xAxis: {
          categories: ['空間把握', '判断推理', '資料解釈', '数的推理'],
          title: {
            text: null
          },
          labels: {
            useHTML: true, // Allows HTML formatting in labels
            formatter: function () {
              // Check the category and apply a specific color
              let color;
              if (this.value === '空間把握') color = '#FF19B6';
              else if (this.value === '判断推理') color = '#FFA13C';
              else if (this.value === '資料解釈') color = '#009C00';
              else if (this.value === '数的推理') color = '#3B82F6';

              // Return the label with inline style
              return `<span style="color: ${color}; font-weight: normal;">${this.value}</span>`;
            }
          }
        },
        yAxis: {
          min: 0,
          max: 120, // Set the y-axis maximum to 100%
          tickInterval: 20, // Sets interval to display 0, 20, 40, 60, 80, 100
          title: {
            text: ''
          },
          labels: {
            enabled: true, // Show values on the left side
            formatter: function () {
              // Only display ticks up to 100, hide 120%
              return this.value === 120 ? null : this.value;
            }
          },
          gridLineWidth: 0,
          plotLines: [
            {
              value: 0,
              color: 'rgba(224, 224, 224, 1)',
              width: 1
            },
            {
              value: 20,
              color: 'rgba(224, 224, 224, 1)',
              width: 1
            },
            {
              value: 40,
              color: 'rgba(224, 224, 224, 1)',
              width: 1
            },
            {
              value: 60,
              color: 'rgba(224, 224, 224, 1)',
              width: 1
            },
            {
              value: 80,
              color: 'rgba(224, 224, 224, 1)',
              width: 1
            },
            {
              value: 100,
              color: 'rgba(224, 224, 224, 1)',
              width: 1
            }
          ]
        },
        tooltip: {
          enabled: false
        },
        series: [{
          data: [
            {
              y: spatialAwarenessPercent,
              color: '#FF19B6',
              dataLabels: {
                color: '#FF19B6',
                enabled: true,
                format: spatialAwarenessPercent + '%', // Set label to show 100%
                style: {
                  fontSize: '14px',
                  fontWeight: 'normal',
                  textOutline: 'none'
                },
              }
            }, // Color for 基礎
            {
              y: logicalReasoningPercent,
              color: '#FFA13C',
              dataLabels: {
                color: '#FFA13C',
                enabled: true,
                format: logicalReasoningPercent + '%', // Set label to show 100%
                style: {
                  fontSize: '14px',
                  fontWeight: 'normal',
                  textOutline: 'none'
                }
              }
            },  // Color for 応用
            {
              y: dataInterpretationPercent,
              color: '#009C00',
              dataLabels: {
                color: '#009C00',
                enabled: true,
                format: dataInterpretationPercent + '%',
                style: {
                  fontSize: '14px',
                  fontWeight: 'normal',
                  textOutline: 'none'
                }
              }
            },
            {
              y: numericalReasoningPercent,
              color: '#3B82F6',
              dataLabels: {
                color: '#3B82F6',
                enabled: true,
                format: numericalReasoningPercent + '%',
                style: {
                  fontSize: '14px',
                  fontWeight: 'normal',
                  textOutline: 'none'
                }
              }
            }
          ],
          showInLegend: false, // Hides the legend
        }],
        plotOptions: {
          column: {
            colorByPoint: true,
          }
        },
        credits: {
          enabled: false
        }
      });

      const spatialAwarenessLabel = document.getElementById('spatialAwarenessLabel')
      const spatialAwarenessAlpha = document.getElementById('spatialAwarenessAlpha')
      const spatialAwarenessLabelMobile = document.getElementById('spatialAwarenessLabelMobile')
      const spatialAwarenessAlphaMobile = document.getElementById('spatialAwarenessAlphaMobile')

      const logicalReasoningLabel = document.getElementById('logicalReasoningLabel')
      const logicalReasoningAlpha = document.getElementById('logicalReasoningAlpha')
      const logicalReasoningLabelMobile = document.getElementById('logicalReasoningLabelMobile')
      const logicalReasoningAlphaMobile = document.getElementById('logicalReasoningAlphaMobile')

      const dataInterpretationLabel = document.getElementById('dataInterpretationLabel')
      const dataInterpretationAlpha = document.getElementById('dataInterpretationAlpha')
      const dataInterpretationLabelMobile = document.getElementById('dataInterpretationLabelMobile')
      const dataInterpretationAlphaMobile = document.getElementById('dataInterpretationAlphaMobile')

      const numericalReasoningLabel = document.getElementById('numericalReasoningLabel')
      const numericalReasoningAlpha = document.getElementById('numericalReasoningAlpha')
      const numericalReasoningLabelMobile = document.getElementById('numericalReasoningLabelMobile')
      const numericalReasoningAlphaMobile = document.getElementById('numericalReasoningAlphaMobile')

      if (spatialAwarenessPercent == 100) {
        spatialAwarenessLabel.innerHTML = "図形や物体をさまざまな角度から見たり、回転させたりする問題を完璧に解く事ができました。<br>ロボット教室でただ漫然とロボットをつくるのではなく、頭の中で完成形をイメージしたり、組み立て写真から他のアングルをイメージしたりといった脳内での作業をよく行えているようです。"
        spatialAwarenessAlpha.textContent = "S"
        spatialAwarenessLabelMobile.innerHTML = "図形や物体をさまざまな角度から見たり、回転させたりする問題を完璧に解く事ができました。<br>ロボット教室でただ漫然とロボットをつくるのではなく、頭の中で完成形をイメージしたり、組み立て写真から他のアングルをイメージしたりといった脳内での作業をよく行えているようです。"
        spatialAwarenessAlphaMobile.textContent = "S"
      } else if (spatialAwarenessPercent >= 50 && spatialAwarenessPercent < 100) {
        spatialAwarenessLabel.innerHTML = "図形や物体をさまざまな角度から見たり、回転させたりする問題の多くを解く事ができました。<br>この力をさらに伸ばすためにロボット教室でただ漫然とロボットをつくるのではなく、頭の中で完成形をイメージしたり、組み立て写真から他のアングルをイメージしたりといった脳内での作業を行うことが重要です。たとえば「組み立て中に悩んでも、先生に聞く前に一旦もう少し頑張ってみる」といった小さな目標を立ててみるとよいでしょう。"
        spatialAwarenessAlpha.textContent = "A"
        spatialAwarenessLabelMobile.innerHTML = "図形や物体をさまざまな角度から見たり、回転させたりする問題の多くを解く事ができました。<br>この力をさらに伸ばすためにロボット教室でただ漫然とロボットをつくるのではなく、頭の中で完成形をイメージしたり、組み立て写真から他のアングルをイメージしたりといった脳内での作業を行うことが重要です。たとえば「組み立て中に悩んでも、先生に聞く前に一旦もう少し頑張ってみる」といった小さな目標を立ててみるとよいでしょう。"
        spatialAwarenessAlphaMobile.textContent = "A"
      } else {
        spatialAwarenessLabel.innerHTML = "図形や物体をさまざまな角度から見たり、回転させたりする問題が、やや苦手なようです。<br>ロボット教室でただ漫然とロボットをつくるのではなく、頭の中で完成形をイメージしたり、組み立て写真から他のアングルをイメージしたりといった脳内での作業を行うことが、この力を伸ばすための近道です。まずは、ロボット組み立てを「いまよりほんの少しだけ手早く、正確に、自力で」やってみる、ということにチャレンジしてみるとよいでしょう。"
        spatialAwarenessAlpha.textContent = "B"
        spatialAwarenessLabelMobile.innerHTML = "図形や物体をさまざまな角度から見たり、回転させたりする問題が、やや苦手なようです。<br>ロボット教室でただ漫然とロボットをつくるのではなく、頭の中で完成形をイメージしたり、組み立て写真から他のアングルをイメージしたりといった脳内での作業を行うことが、この力を伸ばすための近道です。まずは、ロボット組み立てを「いまよりほんの少しだけ手早く、正確に、自力で」やってみる、ということにチャレンジしてみるとよいでしょう。"
        spatialAwarenessAlphaMobile.textContent = "B"
      }

      if (logicalReasoningPercent == 100) {
        logicalReasoningLabel.innerHTML = "身の回りの機械を観察してそのしくみの意味を考えたり、ロボットの試作機から改善案を考えたりする問題を完璧に解くことができました。<br>「もの自体は見たことがあるが、そういえばどうしてこんなつくりになっているんだろう」というのは改めて考えると案外難しいものですが、ロボット作りを通じてさまざまな機械のしくみに注目し、その特徴やメリットを考え、言語化する習慣がしっかりついているようです。"
        logicalReasoningAlpha.textContent = "S"
        logicalReasoningLabelMobile.innerHTML = "身の回りの機械を観察してそのしくみの意味を考えたり、ロボットの試作機から改善案を考えたりする問題を完璧に解くことができました。<br>「もの自体は見たことがあるが、そういえばどうしてこんなつくりになっているんだろう」というのは改めて考えると案外難しいものですが、ロボット作りを通じてさまざまな機械のしくみに注目し、その特徴やメリットを考え、言語化する習慣がしっかりついているようです。"
        logicalReasoningAlphaMobile.textContent = "S"
      } else if (logicalReasoningPercent >= 50 && logicalReasoningPercent < 100) {
        logicalReasoningLabel.innerHTML = "身の回りの機械を観察してそのしくみの意味を考えたり、ロボットの試作機から改善案を考えたりする問題の多くを解く事ができました。<br>この力は「今何が分かっていて、何が分かっていないのか、何を知りたいと思っているのか」を言語化するのが上達の近道です。「もの自体は見たことがあるが、そういえばどうしてこんなつくりになっているんだろう」というのをお子さまと一緒に考えてみたり、ロボット作りのなかで登場した機構があればその特徴やメリットを授業後にお子さまから教えてもらうなど、「言語化」の機会をたくさん用意してあげられるとよいでしょう。"
        logicalReasoningAlpha.textContent = "A"
        logicalReasoningLabelMobile.innerHTML = "身の回りの機械を観察してそのしくみの意味を考えたり、ロボットの試作機から改善案を考えたりする問題の多くを解く事ができました。<br>この力は「今何が分かっていて、何が分かっていないのか、何を知りたいと思っているのか」を言語化するのが上達の近道です。「もの自体は見たことがあるが、そういえばどうしてこんなつくりになっているんだろう」というのをお子さまと一緒に考えてみたり、ロボット作りのなかで登場した機構があればその特徴やメリットを授業後にお子さまから教えてもらうなど、「言語化」の機会をたくさん用意してあげられるとよいでしょう。"
        logicalReasoningAlphaMobile.textContent = "A"
      } else {
        logicalReasoningLabel.innerHTML = "身の回りの機械を観察してそのしくみの意味を考えたり、ロボットの試作機から改善案を考えたりする問題の多くを解く事ができました。 この力は「今何が分かっていて、何が分かっていないのか、何を知りたいと思っているのか」を言語化するのが上達の近道です。「もの自体は見たことがあるが、そういえばどうしてこんなつくりになっているんだろう」というのをお子さまと一緒に考えてみたり、ロボット作りのなかで登場した機構があればその特徴やメリットを授業後にお子さまから教えてもらうなど、「言語化」の機会をたくさん用意してあげられるとよいでしょう。"
        logicalReasoningAlpha.textContent = "B"
        logicalReasoningLabelMobile.innerHTML = "身の回りの機械を観察してそのしくみの意味を考えたり、ロボットの試作機から改善案を考えたりする問題の多くを解く事ができました。 この力は「今何が分かっていて、何が分かっていないのか、何を知りたいと思っているのか」を言語化するのが上達の近道です。「もの自体は見たことがあるが、そういえばどうしてこんなつくりになっているんだろう」というのをお子さまと一緒に考えてみたり、ロボット作りのなかで登場した機構があればその特徴やメリットを授業後にお子さまから教えてもらうなど、「言語化」の機会をたくさん用意してあげられるとよいでしょう。"
        logicalReasoningAlphaMobile.textContent = "B"
      }

      if (dataInterpretationPercent == 100) {
        dataInterpretationLabel.innerHTML = "複雑な図面や文章から、必要な情報を完璧に読み解く事ができました。<br>問題文に対して答えを出すのではなく、情報がちりばめられた資料から問題を解くカギを見つけ、問題を解決することができているようです。"
        dataInterpretationAlpha.textContent = "S"
        dataInterpretationLabelMobile.innerHTML = "複雑な図面や文章から、必要な情報を完璧に読み解く事ができました。<br>問題文に対して答えを出すのではなく、情報がちりばめられた資料から問題を解くカギを見つけ、問題を解決することができているようです。"
        dataInterpretationAlphaMobile.textContent = "S"
      } else if (dataInterpretationPercent >= 50 && dataInterpretationPercent < 100) {
        dataInterpretationLabel.innerHTML = "複雑な図面や文章から、必要な情報を読み解く事ができました。<br>問題文に対してただ答えを出すのではなく、情報がちりばめられた資料から問題を解くカギを見つけ、問題を解決することを意識すると、より良い結果を得られるでしょう。"
        dataInterpretationAlpha.textContent = "A"
        dataInterpretationLabelMobile.innerHTML = "複雑な図面や文章から、必要な情報を読み解く事ができました。<br>問題文に対してただ答えを出すのではなく、情報がちりばめられた資料から問題を解くカギを見つけ、問題を解決することを意識すると、より良い結果を得られるでしょう。"
        dataInterpretationAlphaMobile.textContent = "A"
      } else {
        dataInterpretationLabel.innerHTML = "複雑な図面や文章から読み解くことができなかった情報がいくつかあるようです。<br>資料を読む際には、重要だと感じる単語に印をつけたり、図の中に情報を書き込んだりと、情報を取りこぼさないようにする習慣をつけると良いでしょう。"
        dataInterpretationAlpha.textContent = "B"
        dataInterpretationLabelMobile.innerHTML = "複雑な図面や文章から読み解くことができなかった情報がいくつかあるようです。<br>資料を読む際には、重要だと感じる単語に印をつけたり、図の中に情報を書き込んだりと、情報を取りこぼさないようにする習慣をつけると良いでしょう。"
        dataInterpretationAlphaMobile.textContent = "B"
      }

      if (numericalReasoningPercent == 100) {
        numericalReasoningLabel.innerHTML = "ロボットを作る上で必要な数字の処理を完璧に行うことができています。<br>ロボットの性能を計算で求めたり、設計に必要な数値を与えられた情報から計算したりと、数字の意味まで捉えて計算することができているようです。"
        numericalReasoningAlpha.textContent = "S"
        numericalReasoningLabelMobile.innerHTML = "ロボットを作る上で必要な数字の処理を完璧に行うことができています。<br>ロボットの性能を計算で求めたり、設計に必要な数値を与えられた情報から計算したりと、数字の意味まで捉えて計算することができているようです。"
        numericalReasoningAlphaMobile.textContent = "S"
      } else if (numericalReasoningPercent >= 50 && numericalReasoningPercent < 100) {
        numericalReasoningLabel.innerHTML = "ロボットを作る上で必要な数字の処理を行うことができています。<br>ロボットの性能を計算で求めたり、設計に必要な数値を与えられた情報から計算したりと、数字の意味まで捉えて計算することを意識すると、より良い結果が得られるでしょう。"
        numericalReasoningAlpha.textContent = "A"
        numericalReasoningLabelMobile.innerHTML = "ロボットを作る上で必要な数字の処理を行うことができています。<br>ロボットの性能を計算で求めたり、設計に必要な数値を与えられた情報から計算したりと、数字の意味まで捉えて計算することを意識すると、より良い結果が得られるでしょう。"
        numericalReasoningAlphaMobile.textContent = "A"
      } else {
        numericalReasoningLabel.innerHTML = "ロボットを作る上で必要な数字の処理を完璧に行うことができなかった問題がいくつかあるようです。<br>出てきた数字を使ってただ計算するだけでなく、その数字にどんな意味があるのか、問題を特にはどんな計算が必要かなどを落ち着いて考える習慣をつけると良いでしょう"
        numericalReasoningAlpha.textContent = "B"
        numericalReasoningLabelMobile.innerHTML = "ロボットを作る上で必要な数字の処理を完璧に行うことができなかった問題がいくつかあるようです。<br>出てきた数字を使ってただ計算するだけでなく、その数字にどんな意味があるのか、問題を特にはどんな計算が必要かなどを落ち着いて考える習慣をつけると良いでしょう"
        numericalReasoningAlphaMobile.textContent = "B"
      }
    }

    getExamReportData()

  </script>

</body>

</html>